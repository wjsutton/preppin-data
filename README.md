<h1 style="font-weight:normal">
  Preppin' Data with Python :snake:
</h1>

Solving [Preppin' Data Challenges](https://preppindata.blogspot.com/) with Python

[![Status](https://img.shields.io/badge/status-active-success.svg)]() [![GitHub Issues](https://img.shields.io/github/issues/wjsutton/preppin-data.svg)](https://github.com/wjsutton/preppin-data/issues) [![GitHub Pull Requests](https://img.shields.io/github/issues-pr/wjsutton/preppin-data.svg)](https://github.com/wjsutton/preppin-data/pulls) [![License](https://img.shields.io/badge/license-MIT-blue.svg)](/LICENSE)

[Twitter][Twitter] :speech_balloon:&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;[LinkedIn][LinkedIn] :necktie:&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;[GitHub :octocat:][GitHub]&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;[Website][Website] :link:

## :a: About 

At the start of 2021 I wanted to improve my data prep skills with Python. 

[Preppin' Data](https://preppindata.blogspot.com/) is a weekly data prep challenge built around [Tableau Prep](https://www.tableau.com/en-gb/products/prep) but the challenges apply to other tools and even coding languages, so ideal practice if you're looking to improve your data prep skills. 

From participating, I'm much more confident in Python and use Python in projects such as working out the [life expectancy of chess pieces](https://github.com/wjsutton/life_expectancy_in_chess) and finding the [resale value of Pokemon trading cards](https://github.com/wjsutton/pokemon_tcg_stockmarket).

Below are my solutions and Python code snippets I regularly use in these challenges.


<!--
Quick Link 
-->

[Twitter]:https://twitter.com/WJSutton12
[LinkedIn]:https://www.linkedin.com/in/will-sutton-14711627/
[GitHub]:https://github.com/wjsutton
[Website]:https://wjsutton.github.io/

## :white_check_mark: 2021 Solutions

| Challenge     | Solution |Challenge     | Solution |Challenge     | Solution |Challenge     | Solution |
| ----------- | ----------- | ----------- | ----------- | ----------- | ----------- | ----------- | ----------- |
| [Week 01](https://preppindata.blogspot.com/2021/01/2021-week-1.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-01.py)       | [Week 14](https://preppindata.blogspot.com/2021/04/2021-week-14-prep-air-in-flight.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-14.py) | [Week 27](https://preppindata.blogspot.com/2021/07/2021-week-27-nba-draft-lottery.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-27.py)       | [Week 40](https://preppindata.blogspot.com/2021/10/2021-week-40-animal-adoptions.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-40.py) 
| [Week 02](https://preppindata.blogspot.com/2021/01/2021-week-2.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-02.py)       | [Week 15](https://preppindata.blogspot.com/2021/04/2021-week-15-restaurant-menu-orders.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-15.py)       | [Week 28](https://preppindata.blogspot.com/2021/07/2021-week-28-its-coming-rome.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-28.py)       | [Week 41](https://preppindata.blogspot.com/2021/10/2021-week-41-southend-stats.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-41.py) 
| [Week 03](https://preppindata.blogspot.com/2021/01/2021-week-3.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-03.py)       | [Week 16](https://preppindata.blogspot.com/2021/04/2021-week-16-super-league.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-16.py)       | [Week 29](https://preppindata.blogspot.com/2021/07/2021-week-29-pd-x-wow-tokyo-2020.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-29.py)       | [Week 42](https://preppindata.blogspot.com/2021/10/2021-week-42-charity-fundraising.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-42.py) 
| [Week 04](https://preppindata.blogspot.com/2021/01/2021-week-4.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-04.py)       | [Week 17](https://preppindata.blogspot.com/2021/04/week-17-timesheet-checks.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-17.py)      | [Week 30](https://preppindata.blogspot.com/2021/07/2021-week-30-lift-your-spirits.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-30.py)       | [Week 43](https://preppindata.blogspot.com/2021/10/2021-week-43-is-that-case.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-43.py) 
| [Week 05](https://preppindata.blogspot.com/2021/02/2021-week-5-dealing-with-duplication.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-05.py)       | [Week 18](https://preppindata.blogspot.com/2021/05/2021-week-18-prep-air-project-overruns.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-18.py)      | [Week 31](https://preppindata.blogspot.com/2021/08/2021-week-36-excelling-in-prep.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-31.py)       | [Week 44](https://preppindata.blogspot.com/2021/11/2021-week-44-on-yer-bike.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-44.py) 
| [Week 06](https://preppindata.blogspot.com/2021/02/2021-week-6-comparing-prize-money-for.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-06.py)       | [Week 19](https://preppindata.blogspot.com/2021/05/2021-week-19-prep-air-project-details.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-19.py)      | [Week 32](https://preppindata.blogspot.com/2021/08/2021-week-32-excelling-through.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-32.py)       | [Week 45](https://preppindata.blogspot.com/2021/11/2021-week-45-spread-knowledge-for-tc.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-45.py) 
| [Week 07](https://preppindata.blogspot.com/2021/02/2021-week-7-vegan-shopping-list.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-07.py)       | [Week 20](https://preppindata.blogspot.com/2021/05/2021-week-20-controlling-complaints.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-20.py)      | [Week 33](https://preppindata.blogspot.com/2021/08/2021-week-33-excelling-at-adding-one.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-33.py)       | [Week 46](https://preppindata.blogspot.com/2021/11/2021-week-46-book-shop-data-modelling.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-46.py) 
| [Week 08](https://preppindata.blogspot.com/2021/02/2021-week-8-karaoke-data.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-08.py)       | [Week 21](https://preppindata.blogspot.com/2021/05/2021-week-21-getting-trolleyed.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-21.py)      | [Week 34](https://preppindata.blogspot.com/2021/08/2021-week-34-excelling-with-lookups.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-34.py)      | [Week 47](https://preppindata.blogspot.com/2021/11/2021-week-47-games-night-viz-collab.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-47.py) 
| [Week 09](https://preppindata.blogspot.com/2021/03/2021-week-9-working-with-strings.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-09.py)       | [Week 22](https://preppindata.blogspot.com/2021/06/2021-week-22-answer-smash.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-22.py)      | [Week 35](https://preppindata.blogspot.com/2021/09/2021-week-35-picture-perfect.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-35.py)      | [Week 48](https://preppindata.blogspot.com/2021/12/2021-week-48-departmental-december.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-48.py) 
| [Week 10](https://preppindata.blogspot.com/2021/02/2021-week-10-pokemon-hierarchies.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-10.py)       | [Week 23](https://preppindata.blogspot.com/2021/06/2021-week-23-nps-for-airlines.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-23.py)      | [Week 36](https://preppindata.blogspot.com/2021/09/2021-week-36-whats-trendy.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-36.py)      |  [Week 49](https://preppindata.blogspot.com/2021/12/2021-week-49-departmental-december.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-49.py) 
| [Week 11](https://preppindata.blogspot.com/2021/03/2021-week-11-cocktail-profit-margins.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-11.py)       | [Week 24](https://preppindata.blogspot.com/2021/06/2021-week-24-c-co-absence-monitoring.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-24.py) | [Week 37](https://preppindata.blogspot.com/2021/09/2021-week-37-re-looking-at-phone.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-37.py)      | [Week 50](https://preppindata.blogspot.com/2021/12/2021-week-50-departmental-december-sales.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-50.py) 
| [Week 12](https://preppindata.blogspot.com/2021/03/2021-week-12-maldives-tourism.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-12.py)       | [Week 25](https://preppindata.blogspot.com/2021/06/2021-week-25-worst-pokemon.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-25.py) | [Week 38](https://preppindata.blogspot.com/2021/09/2021-week-38-trilogy.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-38.py)      | 
| [Week 13](https://preppindata.blogspot.com/2021/03/2021-week-13.html)      | [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-13.py)       | [Week 26](https://preppindata.blogspot.com/2021/06/2021-week-26-rolling-weekly-revenue.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-26.py) | [Week 39](https://preppindata.blogspot.com/2021/09/2021-week-39-painting-bikes.html)      |  [Python](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-39.py)      | 

---


## :snake: Python Snippets

### Reading Files

Reading csv files | Example: [W05 2021](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-05.py)
```
import pandas as pd

df = pd.read_csv('folder\\filename.csv')
```

Reading Excel files | Example: [W04 2021](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-04.py)
```
import pandas as pd

df = pd.read_excel('folder\\filename.xlsx', engine='openpyxl', sheet_name = 'Sheet1')
```

Reading and aggregrating multiple Excel tabs | Example: [W21 2021](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-21.py)
```
import pandas as pd

# Read all Excel tabs and concat as one dateframe
all_tabs = pd.read_excel('folder\\filename.xlsx', sheet_name=None)

# Bring all the sheets together
all_dfs = []
for tab_name, df in all_tabs.items():
    df['sheet_name'] = tab_name
    all_dfs.append(df)
    combined_df = pd.concat(all_dfs, ignore_index=True)
```

Skipping rows and columns in an Excel tab | Example: [W48 2021](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-48.py)
```
import pandas as pd

df = pd.read_excel('folder\\filename.xlsx', engine='openpyxl', sheet_name='Sheet1',nrows= 3,skiprows = range(1,7), usecols = "B:D")
```

### Writing Files

Writing csv files with utf-8 encoding | Example: [W10 2021](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-10.py)
```
import pandas as pd

df.to_csv('folder\\filename.csv', encoding='utf-8-sig', index=False)
```

Writing Excel files | Example: [W14 2021](https://github.com/wjsutton/preppin-data/blob/main/2021/2021-week-14.py)
```
import pandas as pd

with pd.ExcelWriter('folder\\filename.xlsx') as writer:  
    df_1.to_excel(writer, sheet_name='Sheet1', index=False)
    df_2.to_excel(writer, sheet_name='Sheet2', index=False)
    df_3.to_excel(writer, sheet_name='Sheet3', index=False)
```

### DataFrame Transformations

Unioning dataframes together with concat
```
import pandas as pd

df_total = pd.concat([df1,df2,df3])
```

Replacing null values with zero, blank, previous or preceeding values
```
import pandas as pd

# replace nulls with zeroes
df['Column with nulls'] = df['Column with nulls'].fillna(0)

# replace nulls with empty string (blank)
df['Column with nulls'] = df['Column with nulls'].fillna('')

# replace nulls with previous non-null value
df['Column with nulls'] = df['Column with nulls'].fillna(method='ffill')

# replace nulls with next non-null value
df['Column with nulls'] = df['Column with nulls'].fillna(method='bfill')
```

### Aggregrating data

Create aggregrated columns grouped by other columns
```
import pandas as pd

df = df.groupby(['Col1','Col2']).agg(col3_min=('Col3','min'),col3_max=('Col3','max'),col3_sum=('Col3','sum')).reset_index()
```

### Data Clean-up

Rename single column
```
import pandas as pd

df.rename( columns={'Col1':'Col1_New_Name'}, inplace=True )
```